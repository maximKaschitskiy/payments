(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(7039)}])},7039:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return K}});var a,r=n(5893),i=n(6042),o=n(603),s=n(7294),u=n(9008),c=n.n(u),l=n(3299),d=n(6624),m=n(5861),p=n(4924),h=n(6829),x=n(3156),f=n(5113),g=n(4472),b=n(3578),v=(0,h.Z)(x.Z,{name:"MainWrapper"})((a={borderRadius:"5px",boxShadow:"0 0 1rem 0 rgba(0, 0, 0, 0.2)",position:"absolute",background:"#ffe897"},(0,p.Z)(a,"background","-moz-radial-gradient(top right, #ffe897, #f98a05)"),(0,p.Z)(a,"background","radial-gradient(to bottom left, #ffe897, #f98a05)"),(0,p.Z)(a,"background","-webkit-radial-gradient(top right, #ffe897, #f98a05)"),(0,p.Z)(a,"background","#e0e793"),(0,p.Z)(a,"background","-moz-radial-gradient(bottom right, #e0e793, #6dd0f1)"),(0,p.Z)(a,"background","radial-gradient(to top left, #e0e793, #6dd0f1)"),(0,p.Z)(a,"background","-webkit-radial-gradient(bottom right, #e0e793, #6dd0f1)"),(0,p.Z)(a,"zIndex","-1"),(0,p.Z)(a,"left","0"),(0,p.Z)(a,"right","0"),(0,p.Z)(a,"marginLeft","auto"),(0,p.Z)(a,"marginRight","auto"),(0,p.Z)(a,"width","100%"),(0,p.Z)(a,"overflow","hidden"),a)),Z=(0,h.Z)(f.Z,{name:"MainFormWrapper"})({backgroundColor:"rgba(255,255,255,0.3)",backdropFilter:"blur(10px) saturate(100%) contrast(45%) brightness(130%)"}),j=(0,h.Z)(g.Z,{name:"StyledStepper"})({"& .Mui-active":{color:"#000000 !important"},"& .Mui-completed":{color:"#212121 !important"},"& .Mui-disabled":{color:"#757575 !important"}}),S=(0,h.Z)(b.Z,{name:"StyledStepLabel"})({"& .Mui-active":{color:"#000000 !important"},"& .Mui-completed":{color:"#212121 !important"},"& .Mui-disabled":{color:"#757575 !important"}}),k=n(9396),y=n(4231),P=n(7568),w=n(4051),C=n.n(w);function N(e,t){return B.apply(this,arguments)}function B(){return(B=(0,P.Z)(C().mark((function e(t,n){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return e.abrupt("return",t.toString().length===n);case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){return(L=(0,P.Z)(C().mark((function e(t){var n,a,r,i,o;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=11;break}if(!t.match(/^(0\d|1[0-2])\/\d{4}$/)){e.next=8;break}return n=t.split("/"),a=n[0],r=n[1],i=new Date(r,a),o=new Date,e.abrupt("return",i.getTime()>o.getTime());case 8:case 11:return e.abrupt("return",!1);case 9:e.next=12;break;case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T=y.Ry().shape({name:y.Z_().min(2,"Too Short!").max(50,"Too Long!").required("Required"),email:y.Z_().email("Invalid email").required("Required")}),R=y.Ry().shape({amount:y.Rx().required("Required"),cardNumber:y.Rx().required("Required").test("cvv","Too Short!",(function(e){return N(e,16)})),expDate:y.Z_().required("Required").min(7,"Too Short!").max(7,"Too Short!").test("expDate","Not a valid",(function(e){return function(e){return L.apply(this,arguments)}(e)})),cvv:y.Rx().required("Required").test("cvv","Too Short!",(function(e){return N(e,3)}))}),_=n(4054);var q=function(e){var t=e.name,n=(e.buttonText,e.url,e.text,e.children),a=(e.onLoad,e.onSubmit),i=e.formClassName,o=(e.fieldsetClassName,e.bottomLink,e.linkText,e.refLink);return(0,r.jsx)(_.Z,{name:t,method:"post",className:"form ".concat(i),noValidate:!0,onSubmit:a,ref:o,xs:12,md:12,sx:{display:"flex",justifyContent:"center"},children:n})},$=n(7357),D=n(4257),E=n(8456),A=(0,h.Z)(D.Z,{name:"StyledButtonStep"})({borderRadius:"2.5px",border:"2px solid #000",backgroundColor:"white",color:"black",transition:"all ease 0.6s",background:"linear-gradient(75deg, black 50%, white 50%)",backgroundSize:"250% 100%",backgroundPosition:"right bottom","&:hover":{color:"#fff",backgroundPosition:"left bottom"}}),M=(0,h.Z)(E.Z,{name:"StyledCircularProgress"})({}),W=function(e){var t=e.onSubmit,n=e.handleBack,a=e.activeStep,i=e.steps,o=e.loading;return(0,r.jsxs)($.Z,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"center"},children:[0!==a&&(0,r.jsx)($.Z,{sx:{mt:3,mr:.5,position:"relative"},children:(0,r.jsx)(A,{className:"customButton",variant:"contained",onClick:n,sx:{mt:3,ml:1},children:"Back"})}),(0,r.jsx)($.Z,{sx:{mt:3,ml:.5,position:"relative"},children:(0,r.jsx)(A,{className:"customButton",variant:"contained",disabled:o,onClick:function(){t()},sx:{mt:3,ml:1},children:a===i.length-1?"Place order":o?(0,r.jsx)(M,{size:24}):"Next"})})]})},F=n(4033),I=n(9535),V=n(6886),z=(0,h.Z)(V.ZP,{name:"AccountFormWrapper"})({display:"flex",justifyContent:"space-around",alignItems:"center",marginBottom:"20px"}),O=(0,h.Z)(D.Z,{name:"StyledButtonAcoount"})({borderRadius:"2.5px",border:"2px solid #000",backgroundColor:"white",color:"black",transition:"all ease 0.6s",background:"linear-gradient(75deg, black 50%, white 50%)",backgroundSize:"250% 100%",backgroundPosition:"right bottom","&:hover":{color:"#fff",backgroundPosition:"left bottom"}}),X=function(e){var t=e.onSubmit,n=(e.isButtonDisable,e.handleBack),a=e.handleNext,u=e.steps,c=e.activeStep,d=e.getValues,h=e.isAccountEdit,x=e.formData,f=(0,l.useSession)().data,g=s.useRef(),b=(0,o.Z)(s.useState({}),2),v=b[0],Z=b[1],j=(0,o.Z)(s.useState({}),2),S=j[0],y=j[1],P=(0,o.Z)(s.useState(!1),2),w=P[0],C=P[1],N=(0,o.Z)(s.useState(!1),2),B=(N[0],N[1],(0,o.Z)(s.useState(!1),2));B[0],B[1];s.useEffect((function(){Z(f&&!h?{name:f.user.name,email:f.user.email}:{name:x.name,email:x.email})}),[f,g]);var L=function(e){Z((0,k.Z)((0,i.Z)({},v),(0,p.Z)({},e.target.name,e.target.value)))};return(0,r.jsxs)(s.Fragment,{children:[(0,r.jsx)(m.Z,{variant:"h6",gutterBottom:!0,children:"Payment account"}),(0,r.jsxs)(z,{item:!0,xs:12,sm:6,children:[(0,r.jsx)(m.Z,{variant:"subtitle1",sx:w&&!f?{borderBottom:"2px solid #d32f2f"}:{borderBottom:"none"},children:f?"Sign out if you want to change your account":"Sign in to continue"}),(0,r.jsx)(O,{variant:"contained",onClick:f?function(){return(0,l.signOut)()}:function(){return(0,l.signIn)()},startIcon:(0,r.jsx)(I.Z,{}),children:f?"Sign out":"Sign In"})]}),(0,r.jsxs)(q,{buttonText:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c",formClassName:"form_state_post-card",bottomLink:"/",refLink:g,onSubmit:t,children:[(0,r.jsxs)(V.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(V.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(F.Z,{required:!0,id:"name",name:"name",label:"Name",fullWidth:!0,autoComplete:"given-name",variant:"standard",value:v.name||"",onChange:function(e){L(e)},inputProps:{minLength:3,maxLength:30},error:!!S.name&&(!S.name.validity&&w),helperText:w&&S.name?S.name.message:""})}),(0,r.jsx)(V.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(F.Z,{required:!0,id:"email",name:"email",label:"Email",fullWidth:!0,autoComplete:"family-name",variant:"standard",value:v.email||"",onChange:function(e){L(e)},inputProps:{type:"email",minLength:5,maxLength:20},error:!!S.email&&(!S.email.validity&&w),helperText:w&&S.email?S.email.message:""})})]}),(0,r.jsx)(W,{activeStep:c,steps:u,handleBack:n,onSubmit:function(){return function(){var e={};T.validate(v,{abortEarly:!1}).then((function(){C(!1),d(v),a(v)})).catch((function(t){t.inner.map((function(t){e[t.path]={validity:!1,message:t.message}})),y(e),C(!0)}))}()}})]})]})},J=n(7109),U=function(e){var t=e.onSubmit,n=(e.isButtonDisable,e.handleBack),a=e.handleNext,u=e.steps,c=e.activeStep,l=e.getValues,d=e.isLoading,h=s.useRef(),x=(0,o.Z)(s.useState({}),2),f=x[0],g=x[1],b=(0,o.Z)(s.useState({}),2),v=b[0],Z=b[1],j=(0,o.Z)(s.useState(!1),2),S=j[0],y=j[1],P=(0,o.Z)(s.useState(!1),2),w=(P[0],P[1],(0,o.Z)(s.useState(!1),2)),C=(w[0],w[1],(0,o.Z)(s.useState(!1),2)),N=(C[0],C[1],function(e){g((0,k.Z)((0,i.Z)({},f),(0,p.Z)({},e.target.name,e.target.value)))});return(0,r.jsxs)(s.Fragment,{children:[(0,r.jsx)(m.Z,{variant:"h6",gutterBottom:!0,children:"Payment method"}),(0,r.jsxs)(q,{formClassName:"form_state_post-card",refLink:h,onSubmit:t,children:[(0,r.jsxs)(V.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(V.ZP,{item:!0,xs:12,md:6,children:(0,r.jsx)(F.Z,{required:!0,id:"amount",label:"Amount",fullWidth:!0,autoComplete:"cc-amount",variant:"standard",name:"amount",value:f.amount||"",onChange:function(e){/^$|^[0-9]+$/.test(e.target.value)&&N(e)},inputProps:{minLength:2,maxLength:6},InputProps:{startAdornment:(0,r.jsx)(J.Z,{position:"start",children:"$"})},error:!!v.amount&&(!v.amount.validity&&S),helperText:S&&v.amount?v.amount.message:""})}),(0,r.jsx)(V.ZP,{item:!0,xs:12,md:6,children:(0,r.jsx)(F.Z,{required:!0,id:"cardNumber",label:"Card number",fullWidth:!0,autoComplete:"cc-number",variant:"standard",name:"cardNumber",value:f.cardNumber?f.cardNumber.replace(/[^\dA-Z]/g,"").replace(/(.{4})/g,"$1 ").trim():"",onChange:function(e){/^$|^[0-9." "]+$/.test(e.target.value)&&N(e)},inputProps:{minLength:19,maxLength:19},error:!!v.cardNumber&&(!v.cardNumber.validity&&S),helperText:S&&v.cardNumber?v.cardNumber.message:""})}),(0,r.jsx)(V.ZP,{item:!0,xs:12,md:6,children:(0,r.jsx)(F.Z,{required:!0,id:"expDate",label:"Expiry date",fullWidth:!0,autoComplete:"cc-exp",variant:"standard",name:"expDate",value:f.expDate||"",onChange:function(e){/^$|^[0-9./\/]+$/.test(e.target.value)&&(e.target.value=e.target.value.replace(/^(\d\d)(\d)$/g,"$1/$2").replace(/^(\d\d\/\d\d\d\d)(\d+)$/g,"$1/$2").replace(/[^\d\/]/g,""),N(e))},inputProps:{minLength:7,maxLength:7},error:!!v.expDate&&(!v.expDate.validity&&S),helperText:S&&v.expDate?v.expDate.message:""})}),(0,r.jsx)(V.ZP,{item:!0,xs:12,md:6,children:(0,r.jsx)(F.Z,{required:!0,id:"cvv",label:"CVV",fullWidth:!0,autoComplete:"cc-csc",variant:"standard",name:"cvv",value:f.cvv||"",onChange:function(e){/^$|^[0-9]+$/.test(e.target.value)&&N(e)},inputProps:{type:"password",minLength:3,maxLength:3},error:!!v.cvv&&(!v.cvv.validity&&S),helperText:S&&v.cvv?v.cvv.message:""})})]}),(0,r.jsx)(W,{activeStep:c,steps:u,handleBack:n,onSubmit:function(){!function(){var e={};R.validate(f,{abortEarly:!1}).then((function(){y(!1),l(f),a(f)})).catch((function(t){console.log(t),t.inner.map((function(t){e[t.path]={validity:!1,message:t.message}})),Z(e),y(!0)}))}()},loading:d})]})]})};function G(e){var t=e.fromApi;return(0,r.jsxs)(s.Fragment,{children:[(0,r.jsx)(m.Z,{variant:"h6",gutterBottom:!0,children:"Review"}),(0,r.jsx)(V.ZP,{container:!0,spacing:2,children:(0,r.jsx)(V.ZP,{item:!0,container:!0,direction:"column",xs:12,sm:6,children:(0,r.jsxs)(V.ZP,{container:!0,spacing:2,children:[(0,r.jsxs)(V.ZP,{item:!0,xs:8,children:[(0,r.jsx)(m.Z,{gutterBottom:!0,children:"Request ID:"}),(0,r.jsx)(m.Z,{gutterBottom:!0,children:t._id})]}),(0,r.jsxs)(V.ZP,{item:!0,xs:8,children:[(0,r.jsx)(m.Z,{gutterBottom:!0,children:"Amount:"}),(0,r.jsx)(m.Z,{gutterBottom:!0,children:t.amount})]})]})})})]})}function H(){var e=["Payment account","Payment details","Review your order"],t=(0,o.Z)(s.useState({}),2),n=t[0],a=t[1],u=(0,o.Z)(s.useState({}),2),p=(u[0],u[1]),h=(0,o.Z)(s.useState({}),2),x=h[0],f=h[1],g=(0,l.useSession)().data,b=(0,o.Z)(s.useState(0),2),k=b[0],y=b[1],P=(0,o.Z)(s.useState(!1),2),w=P[0],C=P[1],N=(0,o.Z)(s.useState(!1),2),B=N[0],L=N[1],T=function(e){return L(!0),e.cardNumber=e.cardNumber.replace(/ /g,""),fetch("api/payment",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","Access-Control-Allow-Credentials":"true"},body:JSON.stringify((0,i.Z)({},e,n))}).then((function(e){return e.ok?e.json():Promise.reject(e)})).then((function(e){f(e),R()})).catch((function(e){console.log(e)})).finally((function(){L(!1)}))},R=function(){y(k+1)},_=function(){y(k-1)};return s.useEffect((function(){!g||n.email===g.user.email&&n.name===g.user.name||C(!0)}),[n,g]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c(),{children:[(0,r.jsx)("title",{children:"Make Payment"}),(0,r.jsx)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"})]}),(0,r.jsx)(v,{component:"main",maxWidth:"sm",children:(0,r.jsxs)(Z,{variant:"outlined",sx:{my:{xs:3,md:6},p:{xs:2,md:3}},children:[(0,r.jsx)(m.Z,{component:"h1",variant:"h4",align:"center",children:"Make payment"}),(0,r.jsx)(d.Z,{activeStep:k,sx:{pt:3,pb:5},children:e.map((function(e){return(0,r.jsx)(j,{children:(0,r.jsx)(S,{children:e})},e)}))}),(0,r.jsx)(s.Fragment,{children:(0,r.jsx)(s.Fragment,{children:function(t){switch(t){case 0:return(0,r.jsx)(X,{activeStep:k,steps:e,handleBack:function(){_()},handleNext:function(){R()},getValues:function(e){a(e)},isAccountEdit:w,formData:n});case 1:return(0,r.jsx)(U,{activeStep:k,steps:e,handleBack:function(){_()},handleNext:function(e){T(e)},getValues:function(e){p(e)},isLoading:B});case 2:return(0,r.jsx)(G,{activeStep:k,fromApi:x});default:throw new Error("Unknown step")}}(k)})})]})})]})}function K(){return(0,r.jsx)(H,{})}}},function(e){e.O(0,[184,774,888,179],(function(){return t=5557,e(e.s=t);var t}));var t=e.O();_N_E=t}]);