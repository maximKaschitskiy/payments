(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(6235)}])},6235:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ae}});var a,r=n(5893),i=n(6042),o=n(603),s=n(7294),u=n(9008),c=n.n(u),l=n(3299),d=n(6624),m=n(5861),p=n(4924),x=n(6829),f=n(3156),h=n(5113),g=n(4472),v=n(3578),b=(0,x.Z)(f.Z,{name:"MainWrapper"})((a={borderRadius:"5px",boxShadow:"0 0 1rem 0 rgba(0, 0, 0, 0.2)",position:"absolute",background:"#ffe897"},(0,p.Z)(a,"background","-moz-radial-gradient(top right, #ffe897, #f98a05)"),(0,p.Z)(a,"background","radial-gradient(to bottom left, #ffe897, #f98a05)"),(0,p.Z)(a,"background","-webkit-radial-gradient(top right, #ffe897, #f98a05)"),(0,p.Z)(a,"background","#e0e793"),(0,p.Z)(a,"background","-moz-radial-gradient(bottom right, #e0e793, #6dd0f1)"),(0,p.Z)(a,"background","radial-gradient(to top left, #e0e793, #6dd0f1)"),(0,p.Z)(a,"background","-webkit-radial-gradient(bottom right, #e0e793, #6dd0f1)"),(0,p.Z)(a,"zIndex","-1"),(0,p.Z)(a,"left","0"),(0,p.Z)(a,"right","0"),(0,p.Z)(a,"marginLeft","auto"),(0,p.Z)(a,"marginRight","auto"),(0,p.Z)(a,"width","100%"),(0,p.Z)(a,"overflow","hidden"),a)),Z=(0,x.Z)(h.Z,{name:"MainFormWrapper"})({backgroundColor:"rgba(255,255,255,0.3)",backdropFilter:"blur(10px) saturate(100%) contrast(45%) brightness(130%)"}),j=(0,x.Z)(g.Z,{name:"StyledStepper"})({"& .Mui-active":{color:"#000000 !important"},"& .Mui-completed":{color:"#212121 !important"},"& .Mui-disabled":{color:"#757575 !important"}}),k=(0,x.Z)(v.Z,{name:"StyledStepLabel"})({"& .Mui-active":{color:"#000000 !important"},"& .Mui-completed":{color:"#212121 !important"},"& .Mui-disabled":{color:"#757575 !important"}}),y=n(9396),S=n(4231),w=n(7568),C=n(4051),P=n.n(C);function N(e,t){return T.apply(this,arguments)}function T(){return(T=(0,w.Z)(P().mark((function e(t,n){return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return e.abrupt("return",t.toString().length===n);case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(){return(B=(0,w.Z)(P().mark((function e(t){var n,a;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=9;break}if(n=t.split("/"),a=n[0],n[1],a>12){e.next=6;break}return e.abrupt("return",!0);case 6:case 9:return e.abrupt("return",!1);case 7:e.next=10;break;case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return(D=(0,w.Z)(P().mark((function e(t){return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return e.abrupt("return",new RegExp(/^(0\d|1[0-2])\/\d{4}$/).test(t));case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(){return(L=(0,w.Z)(P().mark((function e(t){var n,a,r,i,o;return P().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}return n=t.split("/"),a=n[0],r=n[1],i=new Date(r,a),o=new Date,e.abrupt("return",i.getTime()>o.getTime());case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var q=S.Ry().shape({name:S.Z_().min(2,"Too short login").max(50,"Too long login").required("This field is required"),email:S.Z_().email("Invalid email format").required("This field is required")}),_=S.Ry().shape({amount:S.Rx().required("This field is required").min(1,"The amount must be greater than 1"),cardNumber:S.Z_().required("This field is required").test("cardNumber","Format must be xxxx xxxx xxxx xxxx",(function(e){return N(e,19)})),expDate:S.Z_().required("This field is required").test("expDate","Month is not valid",(function(e){return function(e){return B.apply(this,arguments)}(e)})).test("expDate","Format must be mm/yyyy",(function(e){return function(e){return D.apply(this,arguments)}(e)})).test("expDate","Card is expired",(function(e){return function(e){return L.apply(this,arguments)}(e)})),cvv:S.Rx().required("This field is required").test("cvv","Format must be xxx",(function(e){return N(e,3)}))});var $=function(e){var t=e.name,n=(e.buttonText,e.url,e.text,e.children),a=(e.onLoad,e.onSubmit,e.formClassName),i=(e.fieldsetClassName,e.bottomLink,e.linkText,e.refLink);return(0,r.jsx)("form",{onSubmit:function(e){return e.preventDefault()},name:t,method:"post",className:"form ".concat(a),noValidate:!0,ref:i,xs:12,md:12,sx:{display:"flex",justifyContent:"center"},children:n})},R=n(7357),E=n(3321),F=n(8456),A=(0,x.Z)(E.Z,{name:"StyledButtonStep"})({borderRadius:"2.5px",border:"2px solid #000",backgroundColor:"white",color:"black",transition:"all ease 0.6s",background:"linear-gradient(75deg, black 50%, white 50%)",backgroundSize:"250% 100%",backgroundPosition:"right bottom","&:hover":{color:"#fff",backgroundPosition:"left bottom"}}),M=(0,x.Z)(F.Z,{name:"StyledCircularProgress"})({}),W=function(e){var t=e.onSubmit,n=e.handleBack,a=e.activeStep,i=e.steps,o=e.loading;return(0,r.jsxs)(R.Z,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"center"},children:[0!==a&&(0,r.jsx)(R.Z,{sx:{mt:3,mr:.5,position:"relative"},children:(0,r.jsx)(A,{className:"customButton",variant:"contained",onClick:n,sx:{mt:3,ml:1},children:"Back"})}),(0,r.jsx)(R.Z,{sx:{mt:3,ml:.5,position:"relative"},children:(0,r.jsx)(A,{className:"customButton",variant:"contained",disabled:o,onClick:function(){t()},type:"submit",sx:{mt:3,ml:1},children:a===i.length-1?"Place order":o?(0,r.jsx)(M,{size:24}):"Next"})})]})},I=n(4192),O=n(9535),V=n(6886),z=(0,x.Z)(V.ZP,{name:"AccountFormWrapper"})({display:"flex",justifyContent:"space-around",alignItems:"center",marginBottom:"20px"}),J=(0,x.Z)(E.Z,{name:"StyledButtonAcoount"})({borderRadius:"2.5px",border:"2px solid #000",backgroundColor:"white",color:"black",transition:"all ease 0.6s",background:"linear-gradient(75deg, black 50%, white 50%)",backgroundSize:"250% 100%",backgroundPosition:"right bottom","&:hover":{color:"#fff",backgroundPosition:"left bottom"}}),X=function(e){e.onSubmit,e.isButtonDisable;var t=e.handleBack,n=e.handleNext,a=e.steps,u=e.activeStep,c=e.getValues,d=e.formData,x=(0,l.useSession)().data,f=s.useRef(),h=(0,o.Z)(s.useState({}),2),g=h[0],v=h[1],b=(0,o.Z)(s.useState({}),2),Z=b[0],j=b[1],k=(0,o.Z)(s.useState(!1),2),S=k[0],w=k[1],C=(0,o.Z)(s.useState(!1),2),P=(C[0],C[1],(0,o.Z)(s.useState(!1),2));P[0],P[1];s.useEffect((function(){v(x?{name:x.user.name,email:x.user.email}:{name:d.name,email:d.email})}),[x,f]);var N=function(e){v((0,y.Z)((0,i.Z)({},g),(0,p.Z)({},e.target.name,e.target.value)))};return(0,r.jsxs)(s.Fragment,{children:[(0,r.jsx)(m.Z,{variant:"h6",gutterBottom:!0,children:"Payment account"}),(0,r.jsxs)(z,{item:!0,xs:12,sm:6,children:[(0,r.jsx)(m.Z,{variant:"subtitle1",children:x?"Sign out if you want to change your account":"Sign in to continue"}),(0,r.jsx)(J,{variant:"contained",onClick:x?function(){return(0,l.signOut)()}:function(){return(0,l.signIn)()},startIcon:(0,r.jsx)(O.Z,{}),children:x?"Sign out":"Sign In"})]}),(0,r.jsxs)($,{children:[(0,r.jsxs)(V.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(V.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(I.Z,{disabled:!0,required:!0,id:"name",name:"name",label:"Name",fullWidth:!0,autoComplete:"given-name",variant:"standard",value:g.name||"",onChange:function(e){N(e)},inputProps:{minLength:3,maxLength:30},error:!!Z.name&&(!Z.name.validity&&S),helperText:S&&Z.name?Z.name.message:""})}),(0,r.jsx)(V.ZP,{item:!0,xs:12,sm:6,children:(0,r.jsx)(I.Z,{disabled:!0,required:!0,id:"email",name:"email",label:"Email",fullWidth:!0,autoComplete:"family-name",variant:"standard",value:g.email||"",onChange:function(e){N(e)},inputProps:{type:"email",minLength:5,maxLength:35},error:!!Z.email&&(!Z.email.validity&&S),helperText:S&&Z.email?Z.email.message:""})})]}),(0,r.jsx)(W,{activeStep:u,steps:a,handleBack:t,onSubmit:function(){return function(){var e={};q.validate(g,{abortEarly:!1}).then((function(){w(!1),c(g),n(g)})).catch((function(t){t.inner.map((function(t){e[t.path]={validity:!1,message:t.message}})),j(e),w(!0)}))}()}})]})]})},H=n(7109),U=function(e){var t=e.onSubmit,n=(e.isButtonDisable,e.handleBack),a=e.handleNext,u=e.steps,c=e.activeStep,l=e.getValues,d=e.isLoading,x=e.formData,f=s.useRef(),h=(0,o.Z)(s.useState({}),2),g=h[0],v=h[1],b=(0,o.Z)(s.useState({}),2),Z=b[0],j=b[1],k=(0,o.Z)(s.useState(!1),2),S=k[0],w=k[1],C=(0,o.Z)(s.useState(!1),2),P=(C[0],C[1],(0,o.Z)(s.useState(!1),2)),N=(P[0],P[1],(0,o.Z)(s.useState(!1),2));N[0],N[1];s.useEffect((function(){"{}"!==JSON.stringify(x)&&v(x)}),[]);var T=function(e){v((0,y.Z)((0,i.Z)({},g),(0,p.Z)({},e.target.name,e.target.value))),l(g)};return(0,r.jsxs)(s.Fragment,{children:[(0,r.jsx)(m.Z,{variant:"h6",gutterBottom:!0,children:"Payment method"}),(0,r.jsxs)($,{formClassName:"form_state_post-card",refLink:f,onSubmit:t,children:[(0,r.jsxs)(V.ZP,{container:!0,spacing:2,children:[(0,r.jsx)(V.ZP,{item:!0,xs:12,md:6,children:(0,r.jsx)(I.Z,{required:!0,id:"amount",label:"Amount",fullWidth:!0,autoComplete:"cc-amount",variant:"standard",name:"amount",value:g.amount||"",onChange:function(e){/^$|^[0-9]+$/.test(e.target.value)&&T(e)},inputProps:{minLength:2,maxLength:6},InputProps:{startAdornment:(0,r.jsx)(H.Z,{position:"start",children:"$"})},error:!!Z.amount&&(!Z.amount.validity&&S),helperText:S&&Z.amount?Z.amount.message[0]:""})}),(0,r.jsx)(V.ZP,{item:!0,xs:12,md:6,children:(0,r.jsx)(I.Z,{required:!0,id:"cardNumber",label:"Card number",fullWidth:!0,autoComplete:"cc-number",variant:"standard",name:"cardNumber",value:g.cardNumber?g.cardNumber.replace(/[^\dA-Z]/g,"").replace(/(.{4})/g,"$1 ").trim():"",onChange:function(e){/^$|^[0-9." "]+$/.test(e.target.value)&&T(e)},inputProps:{minLength:19,maxLength:19},error:!!Z.cardNumber&&(!Z.cardNumber.validity&&S),helperText:S&&Z.cardNumber?Z.cardNumber.message[0]:""})}),(0,r.jsx)(V.ZP,{item:!0,xs:12,md:6,children:(0,r.jsx)(I.Z,{required:!0,id:"expDate",label:"Expiry date",fullWidth:!0,autoComplete:"cc-exp",variant:"standard",name:"expDate",value:g.expDate||"",onChange:function(e){/^$|^[0-9./\/]+$/.test(e.target.value)&&(e.target.value=e.target.value.replace(/^(\d\d)(\d)$/g,"$1/$2").replace(/^(\d\d\/\d\d\d\d)(\d+)$/g,"$1/$2").replace(/[^\d\/]/g,""),T(e))},inputProps:{minLength:7,maxLength:7},error:!!Z.expDate&&(!Z.expDate.validity&&S),helperText:S&&Z.expDate?Z.expDate.message[0]:""})}),(0,r.jsx)(V.ZP,{item:!0,xs:12,md:6,children:(0,r.jsx)(I.Z,{required:!0,id:"cvv",label:"CVV",fullWidth:!0,autoComplete:"cc-csc",variant:"standard",name:"cvv",value:g.cvv||"",onChange:function(e){/^$|^[0-9]+$/.test(e.target.value)&&T(e)},inputProps:{type:"password",minLength:3,maxLength:3},error:!!Z.cvv&&(!Z.cvv.validity&&S),helperText:S&&Z.cvv?Z.cvv.message[0]:""})})]}),(0,r.jsx)(W,{activeStep:c,steps:u,handleBack:n,onSubmit:function(){_.validate(g,{abortEarly:!1}).then((function(){w(!1),l(g),a(g)})).catch((function(e){if(e.inner){var t={};e.inner.forEach((function(e){t.hasOwnProperty("".concat(e.path))?t[e.path].message.push(e.message):t[e.path]={validity:!1,message:[e.message]}})),j(t),w(!0)}else console.log({err:e})}))},loading:d})]})]})};function G(e){var t=e.fromApi;return(0,r.jsxs)(s.Fragment,{children:[(0,r.jsx)(m.Z,{variant:"h6",gutterBottom:!0,children:"Review"}),(0,r.jsx)(V.ZP,{container:!0,spacing:2,children:(0,r.jsx)(V.ZP,{item:!0,container:!0,direction:"column",xs:12,sm:6,children:(0,r.jsxs)(V.ZP,{container:!0,spacing:2,children:[(0,r.jsxs)(V.ZP,{item:!0,xs:8,children:[(0,r.jsx)(m.Z,{gutterBottom:!0,children:"Request ID:"}),(0,r.jsx)(m.Z,{gutterBottom:!0,children:t._id})]}),(0,r.jsxs)(V.ZP,{item:!0,xs:8,children:[(0,r.jsx)(m.Z,{gutterBottom:!0,children:"Amount:"}),(0,r.jsx)(m.Z,{gutterBottom:!0,children:t.amount})]})]})})})]})}var K=n(6447),Q=n(6798),Y=n(5568),ee=s.forwardRef((function(e,t){return(0,r.jsx)(Y.Z,(0,i.Z)({elevation:6,ref:t,variant:"filled"},e))})),te=function(e){var t=e.handleClose,n=e.isOpen,a=e.status;return(0,r.jsx)(K.Z,{spacing:2,sx:{width:"100%"},children:(0,r.jsx)(Q.Z,{open:n,autoHideDuration:6e3,onClose:function(e,n){return t(e,n)},children:(0,r.jsx)(ee,{onClose:function(e,n){return t(e,n)},severity:a?a.ok?"success":"error":"",sx:{width:"100%"},children:a?"".concat(a.status," : ").concat(a.statusText):""})})})};function ne(){var e=["Payment account","Payment details","Review your order"],t=(0,o.Z)(s.useState({}),2),n=t[0],a=t[1],u=(0,o.Z)(s.useState({}),2),p=u[0],x=u[1],f=(0,o.Z)(s.useState({}),2),h=f[0],g=f[1],v=((0,l.useSession)().data,(0,o.Z)(s.useState(0),2)),y=v[0],S=v[1],w=(0,o.Z)(s.useState(!1),2),C=w[0],P=w[1],N=(0,o.Z)(s.useState(!1),2),T=N[0],B=N[1],D=(0,o.Z)(s.useState(),2),L=D[0],q=D[1],_=function(e){return P(!0),fetch("api/payment",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","Access-Control-Allow-Credentials":"true"},body:JSON.stringify((0,i.Z)({},e,n))}).then((function(e){if(e.ok){var t=e.ok,n=e.status,a=e.statusText;return q({ok:t,status:n,statusText:a}),B(!0),e.json()}return Promise.reject(e)})).then((function(e){g(e),$()})).catch((function(e){console.log({err:e});var t=e.ok,n=e.status,a=e.statusText;q({ok:t,status:n,statusText:a}),B(!0)})).finally((function(){P(!1)}))},$=function(){S(y+1)},R=function(){S(y-1)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(c(),{children:[(0,r.jsx)("title",{children:"Make Payment"}),(0,r.jsx)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"})]}),(0,r.jsx)(b,{component:"main",maxWidth:"sm",children:(0,r.jsxs)(Z,{variant:"outlined",sx:{my:{xs:3,md:6},p:{xs:2,md:3}},children:[(0,r.jsx)(m.Z,{component:"h1",variant:"h4",align:"center",children:"Make payment"}),(0,r.jsx)(d.Z,{activeStep:y,sx:{pt:3,pb:5},children:e.map((function(e){return(0,r.jsx)(j,{children:(0,r.jsx)(k,{children:e})},e)}))}),(0,r.jsx)(s.Fragment,{children:(0,r.jsx)(s.Fragment,{children:function(t){switch(t){case 0:return(0,r.jsx)(X,{activeStep:y,steps:e,handleBack:function(){R()},handleNext:function(){$()},getValues:function(e){a(e)},formData:n});case 1:return(0,r.jsx)(U,{activeStep:y,steps:e,handleBack:function(){R()},handleNext:function(e){_(e)},getValues:function(e){x(e)},formData:p,isLoading:C});case 2:return(0,r.jsx)(G,{activeStep:y,fromApi:h});default:throw new Error("Unknown step")}}(y)})}),(0,r.jsx)(te,{handleClose:function(e,t){return function(e,t){"clickaway"!==t&&B(!1)}(0,t)},isOpen:T,status:L})]})})]})}function ae(){return(0,r.jsx)(ne,{})}}},function(e){e.O(0,[19,774,888,179],(function(){return t=5557,e(e.s=t);var t}));var t=e.O();_N_E=t}]);